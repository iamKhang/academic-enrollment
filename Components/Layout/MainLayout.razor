@inherits LayoutComponentBase
@implements IDisposable
@using Microsoft.AspNetCore.Components.Authorization
@using AcademicEnrollment.Services
@inject AuthenticationStateProvider AuthStateProvider
@inject SidebarService SidebarService

<div class="flex h-screen bg-gray-100">
    <!-- Sidebar -->
    <div class="@(SidebarService.IsOpen ? "w-64" : "w-0") bg-white shadow-lg flex flex-col transition-all duration-300 overflow-hidden">
        <Sidebar />
    </div>
    
    <!-- Toggle Button -->
    <div class="flex items-center justify-center w-6 h-14 bg-blue-500 hover:bg-blue-600 transition-colors cursor-pointer" @onclick="SidebarService.Toggle">
        <i class="fas @(SidebarService.IsOpen ? "fa-chevron-left" : "fa-chevron-right") text-white text-sm transition-all duration-300"></i>
    </div>
    
    <!-- Main content -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6">
            @Body
        </main>
    </div>
</div>

<div id="blazor-error-ui" class="fixed inset-0 bg-red-600 text-white p-4 z-50">
    An unhandled error has occurred.
    <a href="" class="underline">Reload</a>
    <a class="ml-4 cursor-pointer">ðŸ—™</a>
</div>

@code {
    protected override void OnInitialized()
    {
        SidebarService.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        SidebarService.OnChange -= StateHasChanged;
    }
}